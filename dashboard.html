<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agenda Kegiatan Kepala BPS Provinsi Sumatera Barat Tahun 2025</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header class="header">
    <div class="header-content">
      <img src="logo-bps.png" alt="Logo BPS" class="logo">
      <div class="judul">
        <h1>Agenda Kegiatan Kepala BPS</h1>
        <h2>Provinsi Sumatera Barat Tahun 2025</h2>
        <h3 id="bulanDisplay">Bulan: -</h3>
      </div>
    </div>
  </header>

  <main>
    <section class="filter-container">
      <label for="filterBulan">Filter Bulan:</label>
      <select id="filterBulan">
        <option value="">Semua Bulan</option>
        <option value="01">Januari</option>
        <option value="02">Februari</option>
        <option value="03">Maret</option>
        <option value="04">April</option>
        <option value="05">Mei</option>
        <option value="06">Juni</option>
        <option value="07">Juli</option>
        <option value="08">Agustus</option>
        <option value="09">September</option>
        <option value="10">Oktober</option>
        <option value="11">November</option>
        <option value="12">Desember</option>
      </select>

      <input type="text" id="searchInput" placeholder="Cari kegiatan..." />
    </section>

    <div class="table-container">
      <table id="jadwalTable">
        <thead>
          <tr>
            <th>Hari/Tanggal</th>
            <th>Jam Acara</th>
            <th>Nama Kegiatan</th>
            <th>Alamat/Tempat</th>
            <th>Tim</th>
            <th>Keterangan</th>
          </tr>
        </thead>
        <tbody id="jadwalBody"></tbody>
      </table>
    </div>
  </main>
  
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyB0Flu6NacmEFNBr3_8gaqfmmzUi8gJ8Es",
      authDomain: "jadwal-pimpinan-8b0ef.firebaseapp.com",
      projectId: "jadwal-pimpinan-8b0ef",
      storageBucket: "jadwal-pimpinan-8b0ef.firebasestorage.app",
      messagingSenderId: "360212048977",
      appId: "1:360212048977:web:1ff5749cd1416ad08f5c70"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const tbody = document.getElementById("jadwalBody");
    const filterBulan = document.getElementById("filterBulan");
    const searchInput = document.getElementById("searchInput");
    const bulanDisplay = document.getElementById("bulanDisplay");
    let semuaData = [];

    async function ambilData() {
      const querySnapshot = await getDocs(collection(db, "jadwal"));
      semuaData = [];
      querySnapshot.forEach((doc) => {
        semuaData.push(doc.data());
      });
      tampilkanData(semuaData);
    }

    function tampilkanData(data) {
      tbody.innerHTML = "";
      data.forEach((d) => {
        const tr = document.createElement("tr");
        tr.classList.add("baris-jadwal");
        if (d.warna) tr.style.backgroundColor = d.warna;

        tr.innerHTML = `
          <td>${d.hari || ""}</td>
          <td>${d.jam || ""}</td>
          <td>${d.kegiatan || ""}</td>
          <td>${d.tempat || ""}</td>
          <td>${d.tim || ""}</td>
          <td>${d.keterangan || ""}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function filterDanCari() {
      let bulan = filterBulan.value;
      let cari = searchInput.value.toLowerCase();
      let hasil = semuaData.filter((d) => {
        let cocokBulan = !bulan || (d.tanggal && d.tanggal.includes(`-${bulan}-`));
        let cocokCari =
          d.kegiatan?.toLowerCase().includes(cari) ||
          d.tempat?.toLowerCase().includes(cari) ||
          d.tim?.toLowerCase().includes(cari);
        return cocokBulan && cocokCari;
      });
      tampilkanData(hasil);
      bulanDisplay.textContent = bulan ? `Bulan: ${bulan}` : "Bulan: Semua";
    }

    filterBulan.addEventListener("change", filterDanCari);
    searchInput.addEventListener("input", filterDanCari);

    ambilData();
  </script>
</body>
</html>

