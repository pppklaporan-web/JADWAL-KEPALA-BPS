<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Jadwal Pimpinan</title>
  <link rel="icon" type="image/png" href="bps.png" />
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <header>
    <div class="header-logos">
      <img src="bps.png" alt="Logo BPS" class="logo-left" />
      <div class="header-title">
        <h1>JADWAL KEGIATAN PIMPINAN</h1>
        <h2>BPS Provinsi Sumatera Barat</h2>
      </div>
      <img src="se.png" alt="Logo Sensus" class="logo-right" />
    </div>
  </header>

  <section class="judul-bulan">
    <h3 id="judulBulan"></h3>
  </section>

  <div class="filter-container">
    <input type="text" id="cariKegiatan" placeholder="üîç Cari kegiatan..." />
    <select id="filterBulan">
      <option value="">Semua Bulan</option>
      <option value="01">Januari</option>
      <option value="02">Februari</option>
      <option value="03">Maret</option>
      <option value="04">April</option>
      <option value="05">Mei</option>
      <option value="06">Juni</option>
      <option value="07">Juli</option>
      <option value="08">Agustus</option>
      <option value="09">September</option>
      <option value="10">Oktober</option>
      <option value="11">November</option>
      <option value="12">Desember</option>
    </select>
  </div>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Tanggal</th>
          <th>Jam</th>
          <th>Kegiatan</th>
          <th>Tempat</th>
          <th>Tim</th>
          <th>Keterangan</th>
          
        </tr>
      </thead>
      <tbody id="daftarKegiatan"></tbody>
    </table>
  </div>

  <footer>
    <p>¬© 2025 BPS Provinsi Sumatera Barat</p>
  </footer>

  <!-- üî• FIREBASE -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ‚úÖ Pastikan config ini sama persis dengan admin.html
    const firebaseConfig = {
      apiKey: "AIzaSyB0Flu6NacmEFNBr3_8gaqfmmzUi8gJ8Es",
      authDomain: "jadwal-pimpinan-8b0ef.firebaseapp.com",
      projectId: "jadwal-pimpinan-8b0ef",
      storageBucket: "jadwal-pimpinan-8b0ef.firebasestorage.app",
      messagingSenderId: "360212048977",
      appId: "1:360212048977:web:1ff5749cd1416ad08f5c70",
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const colRef = collection(db, "jadwal");

    const daftarKegiatan = document.getElementById("daftarKegiatan");
    const judulBulan = document.getElementById("judulBulan");
    const filterBulan = document.getElementById("filterBulan");
    const cariKegiatan = document.getElementById("cariKegiatan");

    // üß≠ Fungsi menampilkan data
    async function tampilkanKegiatan() {
      const snapshot = await getDocs(colRef);
      daftarKegiatan.innerHTML = "";

      const filterValue = filterBulan.value;
      const cariValue = cariKegiatan.value.toLowerCase();

      snapshot.forEach((docItem) => {
        const data = docItem.data();
        const tanggal = new Date(data.tanggal);
        const bulan = String(tanggal.getMonth() + 1).padStart(2, "0");

        // Filter dan pencarian
        if ((filterValue === "" || bulan === filterValue) &&
            (cariValue === "" || data.kegiatan.toLowerCase().includes(cariValue))) {

          const row = document.createElement("tr");
          row.classList.add(`color-${data.warna || "putih"}`);
          row.innerHTML = `
            <td>${data.tanggal}</td>
            <td>${data.jam}</td>
            <td>${data.kegiatan}</td>
            <td>${data.tempat}</td>
            <td>${data.tim}</td>
            <td>${data.keterangan || "-"}</td>
            
          `;
          daftarKegiatan.appendChild(row);
        }
      });

      // Ganti judul bulan otomatis
      const bulanText = filterBulan.options[filterBulan.selectedIndex].text;
      judulBulan.textContent = filterValue ? `Jadwal Bulan ${bulanText}` : "Semua Jadwal Pimpinan";
    }

    // ‚è± Jalankan otomatis
    tampilkanKegiatan();

    // üîÅ Event listener filter dan pencarian
    filterBulan.addEventListener("change", tampilkanKegiatan);
    cariKegiatan.addEventListener("keyup", tampilkanKegiatan);
  </script>
</body>
</html>


